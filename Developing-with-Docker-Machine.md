# Running docker machine on rancher locally

When running rancher locally from an IDE, rancher will use whichever docker-machine binary is available to it.
To check where this is, one can run `which docker-machine`.

If you are developing docker-machine and would like rancher to run your version, you must first make the binary.
This can be done by navigating to your docker-machine/cmd folder and running `make build`.
Then copy the resulting binary (docker-machine) to the path that was returned by `which docker-machine`. This path is likely /usr/local/bin.

Now, rancher should user your version of docker-machine.

# Dynamically generated driver schemas

Some schemas in Rancher are automatically generated by inspecting docker-machine. For example, the azureConfig (used for creating azure nodes) is generated by inspecting the cli flags in rancher that are prepended with "azure". The azure ones are created in machine/drivers/azure/azure.go.

## Adding fields to driver schemas.

A field can be added to the azureConfig schemas by adding a flag. For example, if I wanted to add a flag for a fallback image to use if the flAzureImage was unavailable, I would follow these steps:
1. in second const block, create constant that stores the flags name in const block:

`flAzureFallbackImage = "azure-fallback-image"`

(Optional) 2. in first const block, create constant that stores default value:

`defaultAzureFallbackImage = "canonical:UbuntuServer:18.04.0-LTS:latest"

3. in driver struct, add corresponding field:

`FallbackImage  string`

4. add statement for initializing field from flags in SetConfigFromFlag function:

_if required field and string value (under required string flags comment):_

`{&d.FallbackImage, flAzureFallbackImage}`

_if optional field or non-string value (under optional flags comment:_

`&d.FallbackImage, flAzureFallbackImage`

5. use field:
in this example, I would probably want to use my new field during the VM creation process. Navigating to the Create function, I can see that a CreateVirtualMachine function (found in azureutil.go) is used. That is where one could add the logic for using the fallback image.
